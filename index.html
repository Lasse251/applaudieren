<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style-sheet.css" />
    <title>Applaudieren</title>
  </head>
  <body>
    <nav class="navbar">
      <button class="burger" id="burger">&#9776;</button>

      <div class="nav-links" id="navLinks">
        <a href="#" class="nav-button" onclick="showUI('karte')">Karte</a>
        <a href="#" class="nav-button" onclick="showUI('spieler')">Spieler</a>
        <a href="#" class="nav-button" onclick="showUI('regeln')">Regeln</a>
        <a href="#" class="nav-button" onclick="showUI('hilfe')">Hilfe</a>
      </div>
    </nav>

    <!--Karten-Men√º-->
    <div class="versteckt" id="karte">
      <div class="inhalt">
        <p class="text" id="currentPlayerText">KARTE F√úR ...</p>
        <div class="card">
          <p class="cardText" id="cardText">Ziehe eine Karte!</p>
        </div>
        <p class="text" id="nextPlayerText">N√ÑCHSTE KARTE F√úR...</p>
        <div class="buttonRow">
          <button class="button" id="spinButton" onclick="handleCard()">
            KARTE ZIEHEN
          </button>
          <button class="squareButton" onclick="showUI('gluecksrad')">
            <img
              class="icon"
              src="sources/gr.png"
              alt="üé°"
              width="40"
              height="40"
            />
          </button>
        </div>
        <p class="text" id="counter">GEZOGENE KARTEN: 0</p>
      </div>
    </div>
    <!--Gl√ºcksrad-Men√º-->
    <div class="versteckt" id="gluecksrad">
      <div class="inhalt">
        <p class="text" id="chosenPlayer">WER DARF APPLAUDIEREN? ...</p>
        <div class="card">
          <canvas id="wheel" width="200" height="200"></canvas>
        </div>
        <div class="buttonRow" style="margin-top: 70px">
          <button class="button" onclick="spinWheel()">Drehen</button>
          <button class="squareButton" onclick="showUI('karte')">
            <img
              class="icon"
              src="sources/x.png"
              alt="X"
              width="40"
              height="40"
            />
          </button>
        </div>
      </div>
    </div>
    <!--Minispiel-Men√º-->
    <!--1. Minispie: Pferderennen-->
    <div class="versteckt" id="minispiel1">
      <div class="inhalt">
        <p class="text" id="currentPlayerText">PFERDERENNEN!</p>
        <div class="cardMinigame">
          <div id="raceTrack">
            <div class="horseRow" id="horse1">üêé</div>
            <div class="horseRow" id="horse2">üêé</div>
            <div class="horseRow" id="horse3">üêé</div>
            <div class="horseRow" id="horse4">üêé</div>
          </div>
        </div>
        <p class="text" id="erklaerungText1">AAA</p>
        <div class="buttonRow">
          <button class="button" id="spinButton" onclick="starteGame()">
            Start
          </button>
          <button class="squareButton" onclick="showUI('karte')">
            <img
              class="icon"
              src="sources/x.png"
              alt="X"
              width="40"
              height="40"
            />
          </button>
        </div>
      </div>
    </div>
    <!--2. Minispiel: Double or Assfuck-->
    <div class="versteckt" id="minispiel2">
      <div class="inhalt">
        <p class="text" id="currentPlayerText">DOUBLE OR ASSFUCK!</p>
        <div class="cardMinigame">
          <p class="cardText" id="amount">Aktueller Stand: 1x</p>
          <p class="cardText" id="nextAmount">N√§chste Stufe: 2x</p>
          <p class="cardText" id="chance">Aktuelle Wahrscheinlichkeit: 80%</p>
        </div>
        <p class="text" id="erklaerungText2">AAA</p>
        <div class="buttonRow">
          <div id="doubleButtonCon">
            <button class="button" id="doubleButton" onclick="doaDouble()">
              DOUBLE
            </button>
          </div>
          <div id="outButtonCon">
            <button class="button" id="outButton" onclick="doaOUT()">
              OUT
            </button>
          </div>
          <button class="squareButton" onclick="showUI('karte')">
            <img
              class="icon"
              src="sources/x.png"
              alt="X"
              width="40"
              height="40"
            />
          </button>
        </div>
      </div>
    </div>
    <!--3. Minispie: Pferderennen-->
    <div class="versteckt" id="minispiel3">
      <div class="inhalt">
        <p class="text" id="currentPlayerText">SLOTMACHINE!</p>
        <div class="card">
          <div class="slotMinigame">
            <div class="slotContainer">
              <div class="reel" id="reel1">‚ùì</div>
              <div class="reel" id="reel2">‚ùì</div>
              <div class="reel" id="reel3">‚ùì</div>
            </div>
            <p class="cardText" id="slotResult">...</p>
          </div>
        </div>
        <p class="text" id="erklaerungText3">AAA</p>
        <div class="buttonRow">
          <select id="einsatz" class="einsatz">
            <option value="1">1 Schluck</option>
            <option value="2">2 Schl√ºcke</option>
            <option value="3">3 Schl√ºcke</option>
          </select>
          <button class="button" id="spinButton" onclick="spinSlot()">
            G√ñNN
          </button>
          <button class="squareButton" onclick="showUI('karte')">
            <img
              class="icon"
              src="sources/x.png"
              alt="X"
              width="40"
              height="40"
            />
          </button>
        </div>
      </div>
    </div>
    <!--4. Minispiel: Timer-->
    <div class="versteckt" id="minispiel4">
      <div class="inhalt">
        <p class="text" id="currentPlayerText">MENSCHLICHE STOPPUHR!</p>
        <div class="cardMinigame">
          <p class="cardText" id="timer">0.000 s</p>
        </div>
        <p class="text" id="erklaerungText4">AAA</p>
        <div class="buttonRow">
            <div id="startStopCon">
              <button class="button" id="startTimerButton" onclick="startTimer()">
                START
              </button>
            </div>
            <button class="button" id="startTimerButton" onclick="resetTimer()">
              RESET
            </button>
          <button class="squareButton" onclick="showUI('karte')">
            <img
              class="icon"
              src="sources/x.png"
              alt="X"
              width="40"
              height="40"
            />
            </div>
          </button>
        </div>
      </div>
    </div>
    <!--Spieler-Men√º-->
    <div class="versteckt" id="spieler">
      <div class="inhalt">
        <div class="spielerMenue">
          <input
            type="text"
            class="input"
            id="spielerInput"
            placeholder="SPIELERNAME"
          />
          <button class="button" onclick="addSpieler()">HINZUF√úGEN</button>
          <p class="noPlayers" id="noPlayers" style="display: none">
            KEINE SPIELER EINGETRAGEN.
          </p>
          <div
            class="spielerListe"
            style="margin-top: 20px; width: 100%"
            id="spielerListe"
          ></div>
          <button class="button" onclick="clearSpieler()">
            SPIELER L√ñSCHEN
          </button>
        </div>
      </div>
    </div>
    <!--Regel-Men√º-->
    <div class="versteckt" id="regeln">
      <div class="inhalt">
        <div class="spielerMenue">
          <h2>ALTERNATIVWORT F√úR TRINKEN</h2>
          <input
            type="text"
            class="input"
            id="wortInput"
            value="applaudieren"
            onchange="changeWord()"
          />
          <h3>EIGENE REGEL ERSTELLEN</h3>
          <input
            type="text"
            class="input"
            id="regelInput"
            placeholder="Eigene Regel"
          />
          <button class="button" onclick="addRegel()">HINZUF√úGEN</button>
          <p class="noRules" id="noRules" style="display: none">
            KEINE REGELN VORHANDEN
          </p>
          <div class="regelListe" id="regelListe">
            <!-- Standard-Regel -->
            <div class="regelContainer">
              <p class="regelText">
                Das Wort "trinken" und W√∂rter mit dem selben Stamm d√ºrfen nicht
                gesagt werden. Stattdessen muss das Alternativwort verwendet
                werden.
              </p>
              <button
                class="deleteButton"
                onclick="this.parentElement.remove()"
              >
                ‚Äì
              </button>
            </div>
          </div>
          <button class="button" onclick="resetRegeln()">ZUR√úCKSETZEN</button>
          <button class="button" onclick="clearRegeln()">REGELN L√ñSCHEN</button>
        </div>
      </div>
    </div>
    <!--Hilfe-Men√º-->
    <div class="versteckt" id="hilfe">
      <div class="inhalt">
        <p class="text">Applaudieren by Lasse</p>
        <p class="text">Erkl√§rung folgt</p>
        <p class="text"><strong>So funktioniert das Spiel:</strong></p>
        <ul class="text">
          <a style="margin-top: 5px; display: block"
            >1. Tragt im Men√º ‚ÄûSPIELER‚Äú alle Mitspieler ein.</a
          ><br />
          <a style="margin-top: 5px; display: block">
            2. Im Men√º ‚ÄûKARTE ZIEHEN‚Äú k√∂nnt ihr reihum Karten ziehen ‚Äì die
            Aufgabe darauf muss erf√ºllt werden. </a
          ><br />
          <a style="margin-top: 5px; display: block">
            3. Statt ‚Äûtrinken‚Äú wird ein alternatives Wort wie ‚Äûapplaudieren‚Äú
            verwendet. Das k√∂nnt ihr im Men√º ‚ÄûREGELN‚Äú √§ndern. </a
          ><br />
          <a style="margin-top: 5px; display: block">
            4. Eigene Zusatzregeln k√∂nnt ihr im Men√º ‚ÄûREGELN‚Äú erg√§nzen. Es gibt
            eine Karte, die es einem Mitspieler erlaubt eine eigene Regel
            aufzustellen.</a
          ><br />
          <a style="margin-top: 5px; display: block">
            5. √úber das ‚ÄûGL√úCKSRAD‚Äú wird zuf√§llig ein Spieler ausgew√§hlt ‚Äì falls
            ihr selber nicht nicht entscheiden wollt, wer trinken soll. </a
          ><br />
        </ul>
        <p class="text">Viel Spa√ü und spielt verantwortungslos!</p>
      </div>
    </div>

    <script>
      let spieler = [];
      let aktuellerIndex = 0;
      let alternativWort = "applaudieren";
      let kartenCounter = 0;
      let minispielCountdown = 5; //Erst 5 Karten, dann ein Minispiel
      const karten = [
        "Die Person links neben dir muss 2x TRINKWORT.",
        "Aufz√§hlung! Suche dir ein beliebiges Thema aus, beginne die Aufz√§hlung. Danach wird die Aufz√§hlung im Uhrzeigersinn fortgesetzt. Der Verlierer muss TRINKWORT. Beispiel: St√§dte mit M -> M√ºnchen, Magdeburg,...",
        "Regel! Stell eine Regel auf, welche f√ºr die Allgemeinheit gilt. Wird gegen diese versto√üen, muss die Person TRINKWORT. F√ºge sie √ºber den Punkt 'Regeln' hinzu.",
        "Quizmaster! NAME ist der Quizmaster. Sollte jemand auf seine Frage antworten, muss diese Person TRINKWORT.",
        "Packe deinen Koffer! Beginne das Spiel, und der Verlierer muss TRINKWORT.",
        "(Kein) Lappen! Alle, die keinen F√ºhrerschein haben, m√ºssen 2x TRINKWORT.",
        "Daumenk√∂nig! Lege deinen Daumen innerhalb der n√§chsten 5 Karten unauff√§llig auf den Tisch. Alle Mitspieler m√ºssen dann ebenfalls ihren Daumen auf den Tisch legen. Der langsamste muss TRINKWORT.",
        "ADEL! Alle m√ºssen dich f√ºr die n√§chsten 10 Runden siezen. Wer sich nicht daran h√§lt, muss TRINKWORT.",
        "Privat! Zeige die letzten drei Bilder aus deiner Galerie. Weigerst du dich, musst du 3x TRINKWORT.",
        "Urlaub! Du bist f√ºr einen Durchgang im Urlaub und musst dich w√§hrenddessen an keine Regeln halten.",
        "Teenies! Alle unter 20 m√ºssen TRINKWORT.",
        "Spielk√∂nig! Der Besitzer des Handys/Laptops darf 3x TRINKWORT verteilen.",
        "TRINKWORT! Jeder muss 1x TRINKWORT.",
        "Weihnachten! Verschenke 3x TRINKWORT an deine Mitspieler.",
        "Gro√üverdiener! Die Person, die am meisten Bargeld bei sich hat, muss 2x TRINKWORT.",
        "Gro√üe Liebe! Suche dir zwei Personen aus, die f√ºr 10 Runden H√§ndchen halten m√ºssen. Weigern sie sich oder schaffen sie es nicht, m√ºssen sie 2x TRINKWORT.",
        "KO-Tropfen! Suche dir ein Getr√§nk eines Mitspielers aus. Von diesem Getr√§nk musst du 2x TRINKWORT. Alkoholfreie Getr√§nke stehen nicht zur Auswahl.",
        "Die Person rechts neben dir muss TRINKWORT.",
        "Schnelles Geld! Die Person, die zuerst ein 1‚Ç¨-St√ºck auf den Tisch legt, darf 3x TRINKWORT verteilen. Sollte es keiner schaffen, m√ºssen alle TRINKWORT.",
        "Ernst! Die Person, die ab jetzt als Erste lacht, muss TRINKWORT. Die Regel gilt so lange, bis jemand lacht.",
        "Rentner! Die √§lteste Person muss 2x TRINKWORT.",
        "Testo! Alle M√§nner m√ºssen TRINKWORT.",
        "Medusa! Keiner darf dir mehr in die Augen schauen. Die ersten drei, die es dennoch tun, m√ºssen TRINKWORT. Nach dem dritten Mal ist der Fluch gebrochen.",
        "D√©j√†-vu! Die Person(en), die zuletzt TRINKWORT mussten, m√ºssen nochmal TRINKWORT.",
        "Reimmeister! Suche dir ein Wort aus. Anschlie√üend wird im Uhrzeigersinn weitergereimt. Zeitlimit: 10 Sekunden. Das Wort muss sich reimen und doppelt genannte W√∂rter sind verboten. Der Verlierer muss 2x TRINKWORT.",
        "Zahl! Nach einem Countdown rufen alle eine Zahl zwischen 1 und 5. Alle Mitspieler mit derselben Zahl m√ºssen TRINKWORT.",
        "Blinzelduell! Fordere einen Mitspieler zu einem Blinzelduell heraus. Der Verlierer muss TRINKWORT.",
        "Trink-Bro! Suche zwei Spieler aus, die f√ºr die n√§chsten 10 Runden Trink-Bros sind. Immer wenn der eine TRINKWORT, muss der andere auch TRINKWORT.",
        "Schneck! Der Spieler mit dem vollsten Glas muss 2x TRINKWORT.",
        "Putzfee! Bis du das n√§chste Mal dran bist, muss der Tisch aufger√§umt sein. Ist er es nicht, musst du 2x TRINKWORT.",
        "Klassenclown! Erz√§hle einen Witz oder eine Story. Lacht keiner, musst du TRINKWORT.",
        "Quizmaster! NAME ist der Quizmaster. Sollte jemand auf seine Frage antworten, muss diese Person TRINKWORT.",
        "Goldene Hochzeit! Die Person mit der l√§ngsten Beziehung muss TRINKWORT.",
        "Regel! Stell eine Regel auf, welche f√ºr die Allgemeinheit gilt. Wird gegen diese versto√üen, muss die Person TRINKWORT. F√ºge sie √ºber den Punkt 'Regeln' hinzu.",
        "Anonym! Keiner darf mehr deinen Vornamen sagen. Macht es dennoch jemand, muss diese(r) TRINKWORT.",
        "Breaking News! Schreibe der Person, mit der du zuletzt auf WhatsApp geschrieben hast, eine Nachricht. Deine Mitspieler entscheiden, welche. Weigerst du dich, musst du 3x TRINKWORT.",
        "Demokratie! Alle Spieler zeigen nach einem Countdown auf eine beliebige Person. Die Person, auf die die meisten Finger zeigen, muss 2x TRINKWORT.",
        "Eiszeit! Friere innerhalb der n√§chsten 5 Runden ein. Alle anderen m√ºssen dann auch einfrieren. Der langsamste muss 2x TRINKWORT.",
        "Freitag der 13.! Z√§hlt im Uhrzeigersinn bis 13. Der 13. muss TRINKWORT.",
        "Arschkarte! Du musst 2x TRINKWORT.",
        "Reste weg! Die Person mit dem leersten Glas muss ihr Glas leer TRINKWORT und nachf√ºllen.",
        "Geschenke! Verteile Geschenke, bzw. 3x TRINKWORT an deine Mitspieler.",
        "Oldtimer! Die Person mit dem √§ltesten Auto muss TRINKWORT.",
        "Tierfreund! Alle mit Haustieren m√ºssen TRINKWORT.",
        "Storytime! Erz√§hle eine wahre und eine falsche Geschichte. Deine Mitspieler entscheiden, welche Geschichte wahr und welche falsch ist. Liegen sie richtig, musst du 2x TRINKWORT. Liegen sie falsch, m√ºssen sie 2x TRINKWORT.",
        "Opas! Alle √ºber 30 m√ºssen TRINKWORT.",
        "Weiber! Alle Frauen m√ºssen TRINKWORT.",
        "Singles! Alle, die Single sind, m√ºssen TRINKWORT.",
        "CBA! Beginnt das Alphabet im Uhrzeigersinn r√ºckw√§rts aufzusagen. Wer einen Fehler macht, muss TRINKWORT.",
        "Saufbirne! Die vollste Person muss 2x TRINKWORT. Die Mehrheit entscheidet.",
        "Schlafnase! Die n√ºchternste Person muss 3x TRINKWORT.",
        "Arschkarte! Du musst 50% deines Getr√§nks TRINKWORT.",
        "SAM, YUK, GU! Z√§hlt im Uhrzeigersinn. Alle Zahlen mit 3, 6 oder 9 d√ºrfen nicht gesagt werden. Stattdessen muss in die H√§nde geklatscht werden. Bei 36 und anderen doppelten Zahlen muss 2x geklatscht werden. Wer verliert, muss 3x TRINKWORT.",
        "Zu h√∂ren! Oder gucken? Fasse dir innerhalb der n√§chsten 5 Karten unauff√§llig ans Ohr. Alle anderen m√ºssen das ebenfalls tun. Der langsamste muss 2x TRINKWORT.",
        "Schnick, Schnack, Schnuck! Spiele gegen einen Mitspieler deiner Wahl Schere, Stein, Papier. Der Verlierer muss 2x TRINKWORT.",
        "Sp√§tz√ºnder! Alle Jungfrauen m√ºssen 2x TRINKWORT.",
        "Reimmeister! Suche dir ein Wort aus. Anschlie√üend wird im Uhrzeigersinn weitergereimt. Zeitlimit: 10 Sekunden. Das Wort muss sich reimen und doppelt genannte W√∂rter sind verboten. Der Verlierer muss 2x TRINKWORT.",
        "Hotel Mama! Alle, die noch zu Hause wohnen, m√ºssen 2x TRINKWORT.",
        "Akademiker! Alle, die studieren oder mal studiert haben, m√ºssen 2x TRINKWORT!",
        "Veraut! Die Person mit dem h√∂chsten Bodycount muss 2x TRINKWORT.",
        "Durstig! Die Person, die am l√§ngsten keinen Sex hatte, muss 2x TRINKWORT. Jungfrauen haben Gl√ºck und z√§hlen nicht dazu.",
        "Freibier! Alle, die gerade Bier trinken, m√ºssen 2x TRINKWORT.",
        "Das Auto! Alle mit einem VW m√ºssen 2x TRINKWORT.",
        "Runter! Mache 10 Liegest√ºtze. Weigerst du dich, musst du 3x TRINKWORT. Traust du dich, aber schaffst es nicht, musst du 1x TRINKWORT.",
        "Erfolgsfan! Alle Bayern-Fans m√ºssen TRINKWORT.",
        "H√∂hepunkt! Wann war dein letzter Orgasmus? Antworte oder 2x TRINKWORT.",
        "Playboy! Wer hatte heute wahrscheinlich am meisten Sex? Die Gruppe stimmt ab ‚Äì die gew√§hlte Person muss 1x TRINKWORT.",
        "Wahrheit! Wurde dir schon mal ein Nacktbild geschickt? Sag von wem oder 1x TRINKWORT. Falls du noch keins bekommen hast, musst du 2x TRINKWORT.",
        "Wahrheit! Hast du schon mal ein Nacktbild verschickt? Sag von wem oder 1x TRINKWORT. Falls du noch keins verschickt hast, musst du 2x TRINKWORT.",
        "Kamasutra! Stelle eine Sexstellung pantomimisch nach. Wer es err√§t, darf 2x TRINKWORT verteilen.",
        "Bondage light! Die Gruppe darf dir 1 Runde lang eine deiner Bewegungen verbieten. Tust du's doch, musst du 2x TRINKWORT.",
      ];

      const burger = document.getElementById("burger");
      const navLinks = document.getElementById("navLinks");

      function toggleMenu() {
        navLinks.classList.toggle("show");
      }
      burger.addEventListener("click", toggleMenu);

      document.querySelectorAll(".nav-links a").forEach((link) => {
        link.addEventListener("click", () => {
          if (window.innerWidth <= 768) {
            navLinks.classList.remove("show");
          }
        });
      });

      function addSpieler() {
        const input = document.getElementById("spielerInput");
        const name = input.value.trim();
        if (name) {
          spieler.push(name);
          input.value = "";
          updateSpielerListe();
          drawWheel();
          updateSpinButtonState();
        }
      }

      function updateSpielerListe() {
        const liste = document.getElementById("spielerListe");
        const noPlayers = document.getElementById("noPlayers");
        liste.innerHTML = "";
        if (spieler.length === 0) {
          noPlayers.style.display = "block";
        } else {
          noPlayers.style.display = "none";
        }
        spieler.forEach((name, index) => {
          const container = document.createElement("div");
          container.className = "regelContainer";
          container.innerHTML = `<p class="regelText">${name}</p>`;
          const btn = document.createElement("button");
          btn.className = "deleteButton";
          btn.textContent = "‚Äì";
          btn.onclick = () => {
            spieler.splice(index, 1);
            if (aktuellerIndex >= spieler.length) {
              aktuellerIndex = 0;
            }
            updateSpielerListe();
            drawWheel();
          };
          container.appendChild(btn);
          liste.appendChild(container);
        });
      }

      function clearSpieler() {
        spieler = [];
        aktuellerIndex = 0;
        updateSpielerListe();
        drawWheel();
        updateSpinButtonState();
      }

      function handleCard() {
        if (spieler.length === 0) {
          document.getElementById("cardText").textContent =
            "F√ºge zuerst Spieler hinzu!";
          return;
        }
        if (minispielCountdown == 0) {
          document.getElementById("karte").classList.add("versteckt");
          const zufallsZahl = Math.floor(Math.random() * 4) + 1;
          //const zufallsZahl = 4;
          if (zufallsZahl == 1) { //Pferderennen
            document.getElementById("minispiel1").classList.remove("versteckt");
            initialisierePferde();
            document.getElementById(
              "erklaerungText1"
            ).innerText = `JEDER MITSPIELER SETZT AUF EIN PFERD.
              GEWINNT DAS GESETZTE PFERD DARF MAN 1x ${alternativWort.toUpperCase()} VERTEILEN.
              VERLIERT DAS PFERD, MUSS MAN 1x ${alternativWort.toUpperCase()}.`;
          } else if (zufallsZahl == 2) { //Double or assfuck
            doaIndex = 0;
            doaChance = 0.8;
            document.getElementById(
              "doubleButtonCon"
            ).innerHTML = `<button class="button" id="doubleButton" onclick="doaDouble()">DOUBLE</button>`;
            document.getElementById(
              "outButtonCon"
            ).innerHTML = `<button class="button" id="outButton" onclick="doaOUT()">
              OUT
            </button>`;
            document.getElementById("minispiel2").classList.remove("versteckt");
            const randomSpieler =
              spieler[Math.floor(Math.random() * spieler.length)];
            document.getElementById(
              "amount"
            ).innerText = `Aktueller Stand: 1x ${alternativWort}.`;
            document.getElementById(
              "chance"
            ).innerText = `Aktuelle Wahrscheinlichkeit: 80%`;
            document.getElementById(
              "nextAmount"
            ).innerText = `N√§chste Stufe: 2x ${alternativWort}.`;
            document.getElementById(
              "erklaerungText2"
            ).innerText = `${randomSpieler.toUpperCase()} SPIELT. STARTET MIT 1x ${alternativWort.toUpperCase()}.
            MIT "DOUBLE" KANN ER VERDOPPELN ‚Äì KLAPPT ES NICHT, MUSS ER SELBST ${alternativWort.toUpperCase()}.
            MIT "OUT" KANN MAN AUSSTEIGEN UND DEN STAND VERTEILEN.
            STUFEN: 1, 2, 4, 8, EXEN`;
          } else if (zufallsZahl == 3) { //Slot
            document.getElementById("minispiel3").classList.remove("versteckt");
            document.getElementById(
              "erklaerungText3"
            ).innerText = `JEDER DREHT 1x MAL AN DER SLOTMACHINE.
            JEDER KANN 1-3x ${alternativWort.toUpperCase()} setzen.
            KEIN GLEICHER EMOJI -> SELBER 1-3x ${alternativWort.toUpperCase()}!
            2x GLEICH -> DOPPELTE ANZAHL VERTEILEN!
            3x GLEICH -> DREIFACHE ANZAHL VERTEILEN!`;
          } else if (zufallsZahl == 4) { //Menschliche Stoppuhr
            document.getElementById("minispiel4").classList.remove("versteckt");
            document.getElementById(
              "erklaerungText4"
            ).innerText = `JEDER STARTET UND STOPPT 1x MAL DIE STOPPUHR.
            NACH 1,5 SEKUNDEN VERSCHWINDET DER TIMER.
            ZIEL IST ES, BEI 10 SEKUNDEN BLIND ZU STOPPEN.
            STOPPT MAN +/- 0,5 SEKUNDEN, VERTEILT MAN 1x ${alternativWort.toUpperCase()}.
            ANSONSTEN MUSS MAN SELBST 1x ${alternativWort.toUpperCase()}!`;
            resetTimer();
          }
          minispielCountdown = Math.round(spieler.length * 1.2 + 5);
          return;
        }

        const current = spieler[aktuellerIndex];
        const next = spieler[(aktuellerIndex + 1) % spieler.length];
        document.getElementById("currentPlayerText").textContent =
          `Karte f√ºr ${current}`.toUpperCase();
        document.getElementById("nextPlayerText").textContent =
          `N√§chste Karte: ${next}`.toUpperCase();
        let randomCard = karten[Math.floor(Math.random() * karten.length)];
        randomCard = randomCard.replace(/TRINKWORT/g, alternativWort);
        randomCard = randomCard.replace(/NAME/g, spieler[aktuellerIndex]);
        document.getElementById("cardText").textContent = randomCard;

        kartenCounter++;
        document.getElementById(
          "counter"
        ).textContent = `GEZOGENE KARTEN: ${kartenCounter}`;

        minispielCountdown = minispielCountdown - 1;

        aktuellerIndex = (aktuellerIndex + 1) % spieler.length;
      }

      function spinWheel() {}

      function addRegel() {
        const input = document.getElementById("regelInput");
        const regel = input.value.trim();
        if (regel) {
          const container = document.createElement("div");
          container.className = "regelContainer";
          container.innerHTML = `<p class='regelText'>${regel}</p>`;
          const btn = document.createElement("button");
          btn.className = "deleteButton";
          btn.textContent = "‚Äì";
          btn.onclick = () => container.remove();
          container.appendChild(btn);
          document.getElementById("regelListe").appendChild(container);
          input.value = "";
          document.getElementById("noRules").style.display = "none";
        }
      }

      function clearRegeln() {
        document.getElementById("regelListe").innerHTML = "";
        document.getElementById("noRules").style.display = "block";
      }

      function resetRegeln() {
        //Regelliste leeren und Standard-Regel hinzuf√ºgen.
        document.getElementById("regelListe").innerHTML = "";
        const container = document.createElement("div");
        container.className = "regelContainer";
        container.innerHTML = `<p class='regelText'>Das Wort "trinken" und W√∂rter mit dem selben Stamm d√ºrfen nicht gesagt werden. Stattdessen muss das Alternativ Wort verwendet werden.</p>`;
        const btn = document.createElement("button");
        btn.className = "deleteButton";
        btn.textContent = "‚Äì";
        btn.onclick = () => container.remove();
        container.appendChild(btn);
        document.getElementById("regelListe").appendChild(container);
        document.getElementById("noRules").style.display = "none";
        //Alternativwort auf Standard
        document.getElementById("wortInput").value = "applaudieren";
      }

      function changeWord() {
        alternativWort = document.getElementById("wortInput").value;
        document.getElementById(
          "chosenPlayer"
        ).innerText = `WER DARF ${alternativWort.toUpperCase()}? ...`;
      }

      function showUI(component) {
        if (component == "karte") {
          document.getElementById("karte").classList.remove("versteckt");
          document.getElementById("spieler").classList.add("versteckt");
          document.getElementById("regeln").classList.add("versteckt");
          document.getElementById("hilfe").classList.add("versteckt");
          document.getElementById("gluecksrad").classList.add("versteckt");
          document.getElementById("minispiel1").classList.add("versteckt");
          document.getElementById("minispiel2").classList.add("versteckt");
          document.getElementById("minispiel3").classList.add("versteckt");
          document.getElementById("minispiel4").classList.add("versteckt");
        } else if (component == "spieler") {
          document.getElementById("karte").classList.add("versteckt");
          document.getElementById("spieler").classList.remove("versteckt");
          document.getElementById("regeln").classList.add("versteckt");
          document.getElementById("hilfe").classList.add("versteckt");
          document.getElementById("gluecksrad").classList.add("versteckt");
          document.getElementById("minispiel1").classList.add("versteckt");
          document.getElementById("minispiel2").classList.add("versteckt");
          document.getElementById("minispiel3").classList.add("versteckt");
          document.getElementById("minispiel4").classList.add("versteckt");
        } else if (component == "regeln") {
          document.getElementById("karte").classList.add("versteckt");
          document.getElementById("spieler").classList.add("versteckt");
          document.getElementById("regeln").classList.remove("versteckt");
          document.getElementById("hilfe").classList.add("versteckt");
          document.getElementById("gluecksrad").classList.add("versteckt");
          document.getElementById("minispiel1").classList.add("versteckt");
          document.getElementById("minispiel2").classList.add("versteckt");
          document.getElementById("minispiel3").classList.add("versteckt");
          document.getElementById("minispiel4").classList.add("versteckt");
        } else if (component == "hilfe") {
          document.getElementById("karte").classList.add("versteckt");
          document.getElementById("spieler").classList.add("versteckt");
          document.getElementById("regeln").classList.add("versteckt");
          document.getElementById("hilfe").classList.remove("versteckt");
          document.getElementById("gluecksrad").classList.add("versteckt");
          document.getElementById("minispiel1").classList.add("versteckt");
          document.getElementById("minispiel2").classList.add("versteckt");
          document.getElementById("minispiel3").classList.add("versteckt");
          document.getElementById("minispiel4").classList.add("versteckt");
        } else if (component == "gluecksrad") {
          document.getElementById("karte").classList.add("versteckt");
          document.getElementById("spieler").classList.add("versteckt");
          document.getElementById("regeln").classList.add("versteckt");
          document.getElementById("hilfe").classList.add("versteckt");
          document.getElementById("gluecksrad").classList.remove("versteckt");
          document.getElementById("minispiel1").classList.add("versteckt");
          document.getElementById("minispiel2").classList.add("versteckt");
          document.getElementById("minispiel3").classList.add("versteckt");
          document.getElementById("minispiel4").classList.add("versteckt");
          drawWheel();
        }
      }
      //beim √∂ffnen Karte anzeigen.
      showUI("karte");

      //Gl√ºcksrad-Logik s/o an ChatGPT:
      const wheelCanvas = document.getElementById("wheel");
      const ctx = wheelCanvas.getContext("2d");
      const spinButton = document.getElementById("spinButton");

      let startAngle = 0;
      let arc = 0;
      let isSpinning = false;
      let spinTimeout;
      let spinAngleStart = 0;
      let spinTime = 0;
      let spinTimeTotal = 0;

      function drawWheel() {
        const numSegments = spieler.length;
        arc = (2 * Math.PI) / numSegments;

        ctx.clearRect(0, 0, wheelCanvas.width, wheelCanvas.height);
        ctx.strokeStyle = "black";
        ctx.lineWidth = 2;
        ctx.font = "bold 16px Arial";
        ctx.textAlign = "right";
        ctx.textBaseline = "middle";

        for (let i = 0; i < numSegments; i++) {
          const angle = startAngle + i * arc;
          // Farbwechsel je Segment
          ctx.fillStyle = i % 2 === 0 ? "#0051ff" : "#427eff";

          ctx.beginPath();
          ctx.moveTo(wheelCanvas.width / 2, wheelCanvas.height / 2);
          ctx.arc(
            wheelCanvas.width / 2,
            wheelCanvas.height / 2,
            wheelCanvas.width / 2 - 10,
            angle,
            angle + arc,
            false
          );
          ctx.lineTo(wheelCanvas.width / 2, wheelCanvas.height / 2);
          ctx.fill();
          ctx.stroke();

          // Textposition (mittig im Segment)
          ctx.save();
          ctx.fillStyle = "black";
          ctx.translate(
            wheelCanvas.width / 2 +
              Math.cos(angle + arc / 2) * (wheelCanvas.width / 2 - 40),
            wheelCanvas.height / 2 +
              Math.sin(angle + arc / 2) * (wheelCanvas.height / 2 - 40)
          );
          ctx.rotate(angle + arc / 2 + Math.PI / 2);
          ctx.fillText(spieler[i], 0, 0);
          ctx.restore();
        }

        // Pfeil oben
        ctx.fillStyle = "black";
        ctx.beginPath();
        ctx.moveTo(wheelCanvas.width / 2 - 10, 10);
        ctx.lineTo(wheelCanvas.width / 2 + 10, 10);
        ctx.lineTo(wheelCanvas.width / 2, 30);
        ctx.closePath();
        ctx.fill();

        updateSpinButtonState();
      }

      function spinWheel() {
        if (spieler.length === 0) {
          document.getElementById(
            "chosenPlayer"
          ).innerText = `OHNE SPIELER GEHTS NICHT!`;
          return;
        }
        if (isSpinning) return;

        isSpinning = true;
        spinAngleStart = Math.random() * 10 + 10; // Drehgeschwindigkeit starten
        spinTime = 0;
        spinTimeTotal = Math.random() * 3000 + 4000; // Dauer 4-7 Sekunden
        rotateWheel();
        spinButton.disabled = true;
      }

      function rotateWheel() {
        spinTime += 30;
        if (spinTime >= spinTimeTotal) {
          stopRotateWheel();
          return;
        }
        const spinAngle =
          spinAngleStart - easeOut(spinTime, 0, spinAngleStart, spinTimeTotal);
        startAngle += (spinAngle * Math.PI) / 180;
        drawWheel();
        spinTimeout = setTimeout(rotateWheel, 30);
      }

      function stopRotateWheel() {
        clearTimeout(spinTimeout);
        isSpinning = false;
        spinButton.disabled = false;
        const degrees = (startAngle * 180) / Math.PI + 90;
        const arcd = (arc * 180) / Math.PI;
        const index =
          Math.floor((360 - (degrees % 360)) / arcd) % spieler.length;
        const selectedPlayer = spieler[index];
        document.getElementById(
          "chosenPlayer"
        ).innerText = `WER DARF ${alternativWort.toUpperCase()}? ${selectedPlayer.toUpperCase()}!`;
      }

      // Ease out Funktion f√ºr sanfte Abbremsung
      function easeOut(t, b, c, d) {
        const ts = (t /= d) * t;
        const tc = ts * t;
        return b + c * (tc + -3 * ts + 3 * t);
      }

      function updateSpinButtonState() {
        spinButton.disabled = spieler.length === 0;
      }

      // Initiales Zeichnen
      if (spieler.length > 0) {
        drawWheel();
        spinButton.disabled = false;
      } else {
        spinButton.disabled = true;
      }

      //Minispiele
      //Pferderennen:
      let intervalId;
      let finished = false;

      function starteGame() {
        resetRace();

        const horses = [
          document.getElementById("horse1"),
          document.getElementById("horse2"),
          document.getElementById("horse3"),
          document.getElementById("horse4"),
        ];

        horses.forEach((horse, i) => {
          horse.style.top = `${i * 40}px`;
          horse.style.left = "0px";
        });

        const trackLength =
          document.querySelector("#raceTrack").offsetWidth - 80;

        intervalId = setInterval(() => {
          horses.forEach((horse, index) => {
            if (finished) return;

            const currentLeft = parseFloat(horse.style.left) || 0;
            const randomStep = Math.random() * 10;
            const newLeft = currentLeft + randomStep;

            horse.style.left = `${Math.min(newLeft, trackLength)}px`;

            if (newLeft >= trackLength) {
              finished = true;
              clearInterval(intervalId);
              horse.textContent += " üèÜ";
            }
          });
        }, 100);
      }

      function initialisierePferde() {
        const horses = [
          document.getElementById("horse1"),
          document.getElementById("horse2"),
          document.getElementById("horse3"),
          document.getElementById("horse4"),
        ];

        horses.forEach((horse, i) => {
          horse.style.top = `${i * 40}px`;
          horse.style.left = "0px";
          horse.textContent = "üêé";
        });
      }

      function resetRace() {
        clearInterval(intervalId);
        finished = false;
        for (let i = 1; i <= 4; i++) {
          const horse = document.getElementById(`horse${i}`);
          horse.style.left = "0px";
          horse.textContent = "üêé";
        }
      }
      //DOUBLE OR ASSFUCK
      let doaAmounts = ["1", "2", "4", "8", "Exen"];
      let doaIndex = 0;
      let doaChance = 0.8;
      function doaDouble() {
        doaIndex++;
        if (doaChance >= Math.random()) {
          document.getElementById(
            "doubleButtonCon"
          ).innerHTML = `<button class="button" id="doubleButton" style="color: green;">ERFOLGREICH!</button>`;
          doaChance = doaChance - 0.1;
          if (doaAmounts[doaIndex] == "Exen") {
            document.getElementById(
              "amount"
            ).innerText = `H√∂chste Stufe!: ${doaAmounts[doaIndex]}x ${alternativWort}.`;
            document.getElementById(
              "nextAmount"
            ).innerText = `Viel Spa√ü beim verteilen!`;
            document.getElementById("chance").innerText = ``;
          } else {
            document.getElementById(
              "amount"
            ).innerText = `Aktueller Stand: ${doaAmounts[doaIndex]}x ${alternativWort}.`;
            if (doaAmounts[doaIndex + 1] == "Exen") {
              document.getElementById(
                "nextAmount"
              ).innerText = `N√§chste Stufe: ${doaAmounts[doaIndex + 1]}.`;
            } else {
              document.getElementById(
                "nextAmount"
              ).innerText = `N√§chste Stufe: ${
                doaAmounts[doaIndex + 1]
              }x ${alternativWort}.`;
            }
            document.getElementById(
              "chance"
            ).innerText = `Aktuele Chance: ${Math.floor(doaChance * 100)}%`;

            setTimeout(() => {
              document.getElementById(
                "doubleButtonCon"
              ).innerHTML = `<button class="button" id="doubleButton" onclick="doaDouble()">DOUBLE</button>`;
            }, 1500);
          }
        } else {
          document.getElementById(
            "doubleButtonCon"
          ).innerHTML = `<button class="button" id="spinButton" style="background-color: red;">VERKACKT!</button>`;
          document.getElementById(
            "outButtonCon"
          ).innerHTML = `<button class="button" id="outButton" onclick="showUI('karte')">ZUR√úCK</button>`;
          document.getElementById("amount").innerText = `Verkackt!`;
          if (doaAmounts[doaIndex] == "Exen") {
            document.getElementById(
              "nextAmount"
            ).innerText = `Du musst selber ${doaAmounts[doaIndex]}.`;
          } else {
            document.getElementById(
              "nextAmount"
            ).innerText = `Du musst selber ${doaAmounts[doaIndex]}x ${alternativWort}.`;
          }
          document.getElementById("chance").innerText = ``;
        }
      }
      function doaOUT() {
        document.getElementById(
          "doubleButtonCon"
        ).innerHTML = `<button class="button" id="spinButton" style="background-color: orange;">OUT!</button>`;
        document.getElementById(
          "outButtonCon"
        ).innerHTML = `<button class="button" id="outButton" onclick="showUI('karte')">ZUR√úCK</button>`;
        document.getElementById("amount").innerText = `OUT!`;
        document.getElementById(
          "nextAmount"
        ).innerText = `Du darfst nun ${doaAmounts[doaIndex]} verteilen.`;
        document.getElementById("chance").innerText = ``;
      }

      // Slot-machine
      const emojis = ["üç∫", "üç∑", "üçæ", "üçª", "üçπ"];

      function spinSlot() {
        const reelEls = [
          document.getElementById("reel1"),
          document.getElementById("reel2"),
          document.getElementById("reel3"),
        ];
        const resultBox = document.getElementById("slotResult");
        const einsatz = parseInt(document.getElementById("einsatz").value);
        const button = document.getElementById("spinButton");

        button.disabled = true;
        resultBox.textContent = "...";

        const outcomeType = getWeightedOutcome();
        const combo = generateCombo(outcomeType);

        reelEls.forEach((reel, i) => {
          reel.textContent = "üé≤";
          setTimeout(() => {
            reel.textContent = combo[i];
          }, 500 + i * 400);
        });

        setTimeout(() => {
          if (outcomeType === 3) {
            resultBox.textContent = `üéâ Dreifach! Verteile ${
              einsatz * 3
            }x ${alternativWort}!`;
          } else if (outcomeType === 2) {
            resultBox.textContent = `Doppel! Verteile ${
              einsatz * 2
            }x ${alternativWort}!`;
          } else {
            resultBox.textContent = `Nichts gleich. Du musst ${einsatz}x ${alternativWort}.`;
          }
          button.disabled = false;
        }, 1800);
      }

      function getWeightedOutcome() {
        const r = Math.random();
        if (r < 0.1) return 3; // 10 %
        if (r < 0.4) return 2; // 30 %
        return 0; // 60 %
      }

      function generateCombo(type) {
        const base = emojis[Math.floor(Math.random() * emojis.length)];

        if (type === 3) return [base, base, base];

        if (type === 2) {
          const second = emojis.find((e) => e !== base);
          const combo = [base, base, second];
          return combo.sort(() => 0.5 - Math.random());
        }

        let unique;
        do {
          unique = [
            emojis[Math.floor(Math.random() * emojis.length)],
            emojis[Math.floor(Math.random() * emojis.length)],
            emojis[Math.floor(Math.random() * emojis.length)],
          ];
        } while (new Set(unique).size !== 3);

        return unique;
      }

      // Menschliche Stoppuhr
      let startTime = 0;
      let timerInterval;
      let running = false;

      function updateTimer() {
        const now = performance.now();
        const elapsed = now - startTime;

        const seconds = Math.floor(elapsed / 1000);
        const milliseconds = Math.floor(elapsed % 1000);
        document.getElementById("timer").textContent = 
            seconds + "." + milliseconds.toString().padStart(3, "0") + " s";
        if (elapsed >= 9500 && elapsed <= 10500) {
          document.getElementById("timer").style.color = "green";
          } else if (elapsed >= 1600) {
            document.getElementById("timer").style.color = "red";
          }
      }

      function startTimer() {
        if (running) return;
        running = true;
        startTime = performance.now();
        timerInterval = setInterval(updateTimer, 10);

        document.getElementById("startStopCon").innerHTML = `<button class="button" id="startTimerButton" onclick="stopTimer()">
              STOP
            </button>`;

        setTimeout(() => {
          document.getElementById("timer").classList.add("versteckt");
          }, 1500);
      }
      
      function stopTimer() {
        running = false;
        document.getElementById("timer").classList.remove("versteckt");
        clearInterval(timerInterval);
      }

      function resetTimer() {
        document.getElementById("timer").style.color = "black";
        stopTimer();
        document.getElementById("timer").innerText = "0.000 s"
        document.getElementById("timer").classList.remove("versteckt");

        document.getElementById("startStopCon").innerHTML = `<button class="button" id="startTimerButton" onclick="startTimer()">
              START
            </button>`; 
      }
    </script>
  </body>
</html>
